<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>PPC test statistics — PPC-test-statistics • bayesplot</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="PPC test statistics — PPC-test-statistics" />

<meta property="og:description" content="The distribution of a (test) statistic T(yrep), or a pair of (test)
statistics, over the simulated datasets in yrep, compared to the
observed value T(y) computed from the data y. See the
Plot Descriptions and Details sections, below, as
well as Gabry et al. (2019)." />

<meta property="og:image" content="https://mc-stan.org/bayesplot/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/bayesplot">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PPC test statistics</h1>
    
    <div class="hidden name"><code>PPC-test-statistics.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The distribution of a (test) statistic <code><a href='https://www.rdocumentation.org/packages/base/topics/logical'>T(yrep)</a></code>, or a pair of (test)
statistics, over the simulated datasets in <code>yrep</code>, compared to the
observed value <code><a href='https://www.rdocumentation.org/packages/base/topics/logical'>T(y)</a></code> computed from the data <code>y</code>. See the
<strong>Plot Descriptions</strong> and <strong>Details</strong> sections, below, as
well as <a href='https://github.com/jgabry/bayes-vis-paper'>Gabry et al. (2019)</a>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ppc_stat</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>stat</span> <span class='kw'>=</span> <span class='st'>"mean"</span>, <span class='no'>...</span>, <span class='kw'>binwidth</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>freq</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>ppc_stat_grouped</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>group</span>, <span class='kw'>stat</span> <span class='kw'>=</span> <span class='st'>"mean"</span>, <span class='no'>...</span>,
  <span class='kw'>facet_args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='kw'>binwidth</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>breaks</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>freq</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>ppc_stat_freqpoly_grouped</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>group</span>, <span class='kw'>stat</span> <span class='kw'>=</span> <span class='st'>"mean"</span>, <span class='no'>...</span>,
  <span class='kw'>facet_args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(), <span class='kw'>binwidth</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>freq</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>ppc_stat_2d</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>stat</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"mean"</span>, <span class='st'>"sd"</span>), <span class='no'>...</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>2.5</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.7</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>A vector of observations. See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>yrep</th>
      <td><p>An \(S\) by \(N\) matrix of draws from the posterior
predictive distribution, where \(S\) is the size of the posterior sample
(or subset of the posterior sample used to generate <code>yrep</code>) and \(N\) is
the number of observations (the length of <code>y</code>). The columns of <code>yrep</code>
should be in the same order as the data points in <code>y</code> for the plots to make
sense. See <strong>Details</strong> for additional instructions.</p></td>
    </tr>
    <tr>
      <th>stat</th>
      <td><p>A single function or a string naming a function, except for
<code>ppc_stat_2d()</code> which requires a vector of exactly two functions or
function names. In all cases the function(s) should take a vector input and
return a scalar statistic. If specified as a string (or strings) then
the legend will display function names. If specified as a function (or
functions) then generic naming is used in the legend.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently unused.</p></td>
    </tr>
    <tr>
      <th>binwidth</th>
      <td><p>Passed to <code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/geom_histogram'>ggplot2::geom_histogram()</a></code> to override
the default binwidth.</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>Passed to <code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/geom_histogram'>ggplot2::geom_histogram()</a></code> as an
alternative to <code>binwidth</code>.</p></td>
    </tr>
    <tr>
      <th>freq</th>
      <td><p>For histograms, <code>freq=TRUE</code> (the default) puts count on the
y-axis. Setting <code>freq=FALSE</code> puts density on the y-axis. (For many
plots the y-axis text is off by default. To view the count or density
labels on the y-axis see the <code><a href='bayesplot-helpers.html'>yaxis_text()</a></code> convenience
function.)</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>A grouping variable (a vector or factor) the same length as
<code>y</code>. Each value in <code>group</code> is interpreted as the group level
pertaining to the corresponding value of <code>y</code>.</p></td>
    </tr>
    <tr>
      <th>facet_args</th>
      <td><p>A named list of arguments (other than <code>facets</code>) passed
to <code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap'>ggplot2::facet_wrap()</a></code> or <code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/facet_grid'>ggplot2::facet_grid()</a></code>
to control faceting.</p></td>
    </tr>
    <tr>
      <th>size, alpha</th>
      <td><p>Arguments passed to <code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>ggplot2::geom_point()</a></code> to control the
appearance of scatterplot points.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A ggplot object that can be further customized using the <strong>ggplot2</strong> package.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For Binomial data, the plots will typically be most useful if
<code>y</code> and <code>yrep</code> contain the "success" proportions (not discrete
"success" or "failure" counts).</p>
    
    <h2 class="hasAnchor" id="plot-descriptions"><a class="anchor" href="#plot-descriptions"></a>Plot Descriptions</h2>

    
    <dl class='dl-horizontal'>
<dt><code>ppc_stat()</code></dt><dd><p>A histogram of the distribution of a test statistic computed by applying
<code>stat</code> to each dataset (row) in <code>yrep</code>. The value of the statistic in the
observed data, <code>stat(y)</code>, is overlaid as a vertical line. More details on
<code>ppc_stat()</code> can be found in Gabry et al. (2019).</p></dd>
<dt><code>ppc_stat_grouped()</code>,<code>ppc_stat_freqpoly_grouped()</code></dt><dd><p>The same as <code>ppc_stat()</code>, but a separate plot is generated for each
level of a grouping variable. In the case of
<code>ppc_stat_freqpoly_grouped()</code> the plots are frequency polygons rather
than histograms. More details on <code>ppc_stat_grouped()</code> can be found in
Gabry et al. (2019).</p></dd>
<dt><code>ppc_stat_2d()</code></dt><dd><p>A scatterplot showing the joint distribution of two test statistics
computed over the datasets (rows) in <code>yrep</code>. The value of the
statistics in the observed data is overlaid as large point.</p></dd>
</dl>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and
Gelman, A. (2019), Visualization in Bayesian workflow.
<em>J. R. Stat. Soc. A</em>, 182: 389-402. doi:10.1111/rssa.12378.
(<a href='https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssa.12378'>journal version</a>,
<a href='https://arxiv.org/abs/1709.01449'>arXiv preprint</a>,
<a href='https://github.com/jgabry/bayes-vis-paper'>code on GitHub</a>)</p>
<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari,
A., and Rubin, D. B. (2013). <em>Bayesian Data Analysis.</em> Chapman &amp; Hall/CRC
Press, London, third edition. (Ch. 6)</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other PPCs: <code><a href='PPC-discrete.html'>PPC-discrete</a></code>,
  <code><a href='PPC-distributions.html'>PPC-distributions</a></code>,
  <code><a href='PPC-errors.html'>PPC-errors</a></code>, <code><a href='PPC-intervals.html'>PPC-intervals</a></code>,
  <code><a href='PPC-loo.html'>PPC-loo</a></code>, <code><a href='PPC-overview.html'>PPC-overview</a></code>,
  <code><a href='PPC-scatterplots.html'>PPC-scatterplots</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='example-data.html'>example_y_data</a></span>()
<span class='no'>yrep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='example-data.html'>example_yrep_draws</a></span>()
<span class='fu'>ppc_stat</span>(<span class='no'>y</span>, <span class='no'>yrep</span>)</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='PPC-test-statistics-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>ppc_stat</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>stat</span> <span class='kw'>=</span> <span class='st'>"sd"</span>) + <span class='fu'><a href='bayesplot-helpers.html'>legend_none</a></span>()</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='PPC-test-statistics-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>ppc_stat_2d</span>(<span class='no'>y</span>, <span class='no'>yrep</span>)</div><div class='img'><img src='PPC-test-statistics-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>ppc_stat_2d</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>stat</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"median"</span>, <span class='st'>"mean"</span>)) + <span class='fu'><a href='bayesplot-helpers.html'>legend_move</a></span>(<span class='st'>"bottom"</span>)</div><div class='img'><img src='PPC-test-statistics-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span>(<span class='st'>"teal"</span>)
<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='example-data.html'>example_group_data</a></span>()
<span class='fu'>ppc_stat_grouped</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>group</span>)</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='PPC-test-statistics-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span>(<span class='st'>"mix-red-blue"</span>)
<span class='fu'>ppc_stat_freqpoly_grouped</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>group</span>, <span class='kw'>facet_args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>nrow</span> <span class='kw'>=</span> <span class='fl'>2</span>))</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='PPC-test-statistics-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># use your own function to compute test statistics</span>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span>(<span class='st'>"brightblue"</span>)
<span class='no'>q25</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>y</span>) <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/quantile'>quantile</a></span>(<span class='no'>y</span>, <span class='fl'>0.25</span>)
<span class='fu'>ppc_stat</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>stat</span> <span class='kw'>=</span> <span class='st'>"q25"</span>) <span class='co'># legend includes function name</span></div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='PPC-test-statistics-7.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># can define the function in the 'stat' argument but then</span>
<span class='co'># the legend doesn't include a function name</span>
<span class='fu'>ppc_stat</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>stat</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>y</span>) <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/quantile'>quantile</a></span>(<span class='no'>y</span>, <span class='fl'>0.25</span>))</div><div class='output co'>#&gt; <span class='message'>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></div><div class='img'><img src='PPC-test-statistics-8.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#plot-descriptions">Plot Descriptions</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Tristan Mahr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

