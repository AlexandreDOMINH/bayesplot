<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>LOO predictive checks — PPC-loo • bayesplot</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">bayesplot</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="http://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="http://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="http://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="http://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/bayesplot">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>LOO predictive checks</h1>
    </div>

    
    <p>Leave-One-Out (LOO) predictive checks. See the <strong>Plot Descriptions</strong>
section below for details.</p>
    

    <pre class="usage"><span class='fu'>ppc_loo_pit</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>lw</span>, <span class='no'>pit</span>, <span class='kw'>compare</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"uniform"</span>, <span class='st'>"normal"</span>), <span class='no'>...</span>,
  <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='fu'>ppc_loo_intervals</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>lw</span>, <span class='kw'>intervals</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.9</span>,
  <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>fatten</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>order</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"index"</span>, <span class='st'>"median"</span>))

<span class='fu'>ppc_loo_ribbon</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>lw</span>, <span class='kw'>intervals</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.9</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.33</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.25</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>A vector of observations. See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>yrep</th>
      <td><p>An \(S\) by \(N\) matrix of draws from the posterior
predictive distribution, where \(S\) is the size of the posterior sample
(or subset of the posterior sample used to generate <code>yrep</code>) and
\(N\) is the number of observations (the length of <code>y</code>). The columns
of <code>yrep</code> should be in the same order as the data points in <code>y</code>
for the plots to make sense. See <strong>Details</strong> for additional
instructions.</p></td>
    </tr>
    <tr>
      <th>lw</th>
      <td><p>A matrix of (smoothed) log weights with the same dimensions as
<code>yrep</code>. See the <code><a href='http://www.rdocumentation.org/packages/loo/topics/psislw'>psislw</a></code> function in the <span class="pkg">loo</span>
package, which returns smoothed weights that can be used to specify
<code>lw</code>.</p></td>
    </tr>
    <tr>
      <th>pit</th>
      <td><p>For <code>ppc_loo_pit</code>, optionally a vector of precomputed PIT
values that can be specified instead of <code>y</code>, <code>yrep</code>, and
<code>lw</code> (these are all ignored if <code>pit</code> is specified). If not
specified the PIT values are computed internally before plotting.</p></td>
    </tr>
    <tr>
      <th>compare</th>
      <td><p>For <code>ppc_loo_pit</code>, a string that can be either
<code>"uniform"</code> or <code>"normal"</code>. If <code>"uniform"</code> (the default) the
Q-Q plot compares computed PIT values to the standard uniform distribution.
If <code>compare="normal"</code>, the Q-Q plot compares standardized PIT values
to the standard normal distribution.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently unused.</p></td>
    </tr>
    <tr>
      <th>alpha, size, fatten</th>
      <td><p>Arguments passed to code geoms to control plot
aesthetics. For <code>ppc_loo_pit</code>, <code>size</code> and <code>alpha</code> are passed
to <code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>geom_point</a></code>. For <code>ppc_loo_intervals</code>,
<code>size</code> and <code>fatten</code> are passed to
<code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_linerange'>geom_pointrange</a></code>. For <code>ppc_loo_ribbon</code>,
<code>alpha</code> and <code>size</code> are passed to
<code><a href='http://www.rdocumentation.org/packages/ggplot2/topics/geom_ribbon'>geom_ribbon</a></code>.</p></td>
    </tr>
    <tr>
      <th>intervals</th>
      <td><p>For <code>ppc_loo_intervals</code> and <code>ppc_loo_ribbon</code>,
optionally a matrix of precomputed LOO predictive intervals intervals with
that can be specified instead of <code>yrep</code> and <code>lw</code> (these are both
ignored if <code>intervals</code> is specified). If not specified the intervals
are computed internally before plotting. If specified, <code>intervals</code>
must be a matrix with number of rows equal to the number of data points and
three columns in the following order: the first for the lower bound of the
interval, the second for median (50%), and the third for the interval
upper bound (column names are ignored).</p></td>
    </tr>
    <tr>
      <th>prob</th>
      <td><p>A value between 0 and 1 indicating the desired probability mass
to include in the intervals. The default is 0.9.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>For <code>ppc_loo_intervals</code> A string indicating how to arrange
the plotted intervals. The default (<code>"index"</code>) is to plot them in the
order of the observations. The alternative (<code>"median"</code>) arranges them
by median value from smallest (left) to largest (right).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A ggplot object that can be further customized using the
  <span class="pkg">ggplot2</span> package.</p>
    
    <h2 class="hasAnchor" id="plot-descriptions"><a class="anchor" href="#plot-descriptions"></a>Plot Descriptions</h2>

    
    <dl class='dl-horizontal'>
<dt><code>ppc_loo_pit</code></dt><dd><p>The calibration of marginal predictions can be assessed using probability
 integral transformation (PIT) checks. LOO improves the check by avoiding the
 double use of data. See the section on marginal predictive checks in Gelman
 et al. (2013, p. 152--153). The default LOO PIT predictive check is a
 quantile-quantile (Q-Q) plot comparing the LOO PITs to the standard uniform
 distribution. Comparing to a uniform distribution is not good for extreme
 probabilities close to 0 and 1, so it can be useful to set the
 <code>compare</code> argument to <code>"normal"</code>, which will produce a Q-Q plot
 comparing standardized PIT values to the standard normal distribution. This
 can be helpful to see the calibration better for the extreme values.</p></dd>
<dt><code>ppc_loo_intervals, ppc_loo_ribbon</code></dt><dd><p>Similar to <code><a href='PPC-intervals.html'>ppc_intervals</a></code> and <code><a href='PPC-intervals.html'>ppc_ribbon</a></code> but the
 intervals are for the LOO predictive distribution.</p></dd>
</dl>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari,
  A., and Rubin, D. B. (2013). <em>Bayesian Data Analysis.</em> Chapman &amp; Hall/CRC
  Press, London, third edition. (p. 152--153)</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical
  Bayesian model evaluation using leave-one-out cross-validation and WAIC.
  <em>Statistics and Computing</em>. 27(5), 1413--1432.
  doi:10.1007/s11222-016-9696-4. arXiv preprint:
  <a href='http://arxiv.org/abs/1507.04544/'>http://arxiv.org/abs/1507.04544/</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>Other PPCs: <code><a href='PPC-discrete.html'>PPC-discrete</a></code>,
  <code><a href='PPC-distributions.html'>PPC-distributions</a></code>,
  <code><a href='PPC-errors.html'>PPC-errors</a></code>, <code><a href='PPC-intervals.html'>PPC-intervals</a></code>,
  <code><a href='PPC-overview.html'>PPC-overview</a></code>,
  <code><a href='PPC-scatterplots.html'>PPC-scatterplots</a></code>,
  <code><a href='PPC-test-statistics.html'>PPC-test-statistics</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='fu'>library</span>(<span class='no'>rstanarm</span>)
<span class='fu'>library</span>(<span class='no'>loo</span>)

<span class='fu'>head</span>(<span class='no'>radon</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/rstanarm/topics/stan_glmer'>stan_lmer</a></span>(<span class='no'>log_radon</span> ~ <span class='no'>floor</span> + <span class='no'>log_uranium</span> + <span class='no'>floor</span>:<span class='no'>log_uranium</span>
                   + (<span class='fl'>1</span> + <span class='no'>floor</span> <span class='kw'>|</span> <span class='no'>county</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>radon</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>radon</span>$<span class='no'>log_radon</span>
<span class='no'>yrep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/rstanarm/topics/posterior_predict.stanreg'>posterior_predict</a></span>(<span class='no'>fit</span>)
<span class='no'>psis</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='http://www.rdocumentation.org/packages/loo/topics/psislw'>psislw</a></span>(-<span class='fu'><a href='http://www.rdocumentation.org/packages/rstanarm/topics/log_lik.stanreg'>log_lik</a></span>(<span class='no'>fit</span>), <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>2</span>)

<span class='co'># marginal predictive check using LOO probability integral transform</span>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span>(<span class='st'>"orange"</span>)
<span class='fu'>ppc_loo_pit</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>lw</span> <span class='kw'>=</span> <span class='no'>psis</span>$<span class='no'>lw_smooth</span>)
<span class='fu'>ppc_loo_pit</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>lw</span> <span class='kw'>=</span> <span class='no'>psis</span>$<span class='no'>lw_smooth</span>, <span class='kw'>compare</span> <span class='kw'>=</span> <span class='st'>"normal"</span>)

<span class='co'># loo predictive intervals vs observations</span>
<span class='no'>sel</span> <span class='kw'>&lt;-</span> <span class='fl'>800</span>:<span class='fl'>900</span>
<span class='fu'>ppc_loo_intervals</span>(<span class='no'>y</span>[<span class='no'>sel</span>], <span class='no'>yrep</span>[, <span class='no'>sel</span>], <span class='no'>psis</span>$<span class='no'>lw_smooth</span>[, <span class='no'>sel</span>],
                  <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)

<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span>(<span class='st'>"gray"</span>)
<span class='fu'>ppc_loo_intervals</span>(<span class='no'>y</span>[<span class='no'>sel</span>], <span class='no'>yrep</span>[, <span class='no'>sel</span>], <span class='no'>psis</span>$<span class='no'>lw_smooth</span>[, <span class='no'>sel</span>],
                  <span class='kw'>order</span> <span class='kw'>=</span> <span class='st'>"median"</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.8</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#plot-descriptions">Plot Descriptions</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Tristan Mahr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
