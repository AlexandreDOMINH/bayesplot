<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>LOO predictive checks — PPC-loo • bayesplot</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="LOO predictive checks — PPC-loo" />

<meta property="og:description" content="Leave-One-Out (LOO) predictive checks. See the Plot Descriptions section,
below, and Gabry et al. (2019)
for details." />

<meta property="og:image" content="https://mc-stan.org/bayesplot/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/bayesplot">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>LOO predictive checks</h1>
    
    <div class="hidden name"><code>PPC-loo.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Leave-One-Out (LOO) predictive checks. See the <strong>Plot Descriptions</strong> section,
below, and <a href='https://github.com/jgabry/bayes-vis-paper'>Gabry et al. (2019)</a>
for details.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ppc_loo_pit_overlay</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>lw</span>, <span class='no'>pit</span>, <span class='kw'>samples</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='no'>...</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.25</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.7</span>, <span class='kw'>trim</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>bw</span> <span class='kw'>=</span> <span class='st'>"nrd0"</span>, <span class='kw'>adjust</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>kernel</span> <span class='kw'>=</span> <span class='st'>"gaussian"</span>, <span class='kw'>n_dens</span> <span class='kw'>=</span> <span class='fl'>1024</span>)

<span class='fu'>ppc_loo_pit_qq</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>lw</span>, <span class='no'>pit</span>, <span class='kw'>compare</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"uniform"</span>, <span class='st'>"normal"</span>), <span class='no'>...</span>,
  <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='fu'>ppc_loo_pit</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>lw</span>, <span class='no'>pit</span>, <span class='kw'>compare</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"uniform"</span>, <span class='st'>"normal"</span>), <span class='no'>...</span>,
  <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='fu'>ppc_loo_intervals</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>psis_object</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>intervals</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>prob_outer</span> <span class='kw'>=</span> <span class='fl'>0.9</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>fatten</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>order</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"index"</span>, <span class='st'>"median"</span>))

<span class='fu'>ppc_loo_ribbon</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='no'>lw</span>, <span class='no'>psis_object</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>intervals</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>, <span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>prob_outer</span> <span class='kw'>=</span> <span class='fl'>0.9</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.33</span>, <span class='kw'>size</span> <span class='kw'>=</span> <span class='fl'>0.25</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>A vector of observations. See <strong>Details</strong>.</p></td>
    </tr>
    <tr>
      <th>yrep</th>
      <td><p>An \(S\) by \(N\) matrix of draws from the posterior
predictive distribution, where \(S\) is the size of the posterior sample
(or subset of the posterior sample used to generate <code>yrep</code>) and \(N\) is
the number of observations (the length of <code>y</code>). The columns of <code>yrep</code>
should be in the same order as the data points in <code>y</code> for the plots to make
sense. See <strong>Details</strong> for additional instructions.</p></td>
    </tr>
    <tr>
      <th>lw</th>
      <td><p>A matrix of (smoothed) log weights with the same dimensions as
<code>yrep</code>. See <code><a href='https://www.rdocumentation.org/packages/loo/topics/psis'>loo::psis()</a></code> and the associated <code><a href='https://www.rdocumentation.org/packages/stats/topics/weights'>weights()</a></code> method as well as
the <strong>Examples</strong> section, below.</p></td>
    </tr>
    <tr>
      <th>pit</th>
      <td><p>For <code>ppc_loo_pit_overlay()</code> and <code>ppc_loo_pit_qq()</code>, optionally a
vector of precomputed PIT values that can be specified instead of <code>y</code>,
<code>yrep</code>, and <code>lw</code> (these are all ignored if <code>pit</code> is specified). If not
specified the PIT values are computed internally before plotting.</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>For <code>ppc_loo_pit_overlay()</code>, the number of data sets (each
the same size as <code>y</code>) to simulate from the standard uniform
distribution. The default is 100. The density estimate of each dataset is
plotted as a thin line in the plot, with the density estimate of the LOO
PITs overlaid as a thicker dark line.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently unused.</p></td>
    </tr>
    <tr>
      <th>alpha, size, fatten</th>
      <td><p>Arguments passed to code geoms to control plot
aesthetics. For <code>ppc_loo_pit_qq()</code> and <code>ppc_loo_pit_overlay()</code>, <code>size</code> and
<code>alpha</code> are passed to <code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/geom_point'>ggplot2::geom_point()</a></code> and
<code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/geom_density'>ggplot2::geom_density()</a></code>, respectively. For <code>ppc_loo_intervals()</code>, <code>size</code>
and <code>fatten</code> are passed to <code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/geom_linerange'>ggplot2::geom_pointrange()</a></code>. For
<code>ppc_loo_ribbon()</code>, <code>alpha</code> and <code>size</code> are passed to
<code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/geom_ribbon'>ggplot2::geom_ribbon()</a></code>.</p></td>
    </tr>
    <tr>
      <th>trim</th>
      <td><p>Passed to <code><a href='https://www.rdocumentation.org/packages/ggplot2/topics/geom_density'>ggplot2::stat_density()</a></code>.</p></td>
    </tr>
    <tr>
      <th>bw, adjust, kernel, n_dens</th>
      <td><p>Optional arguments passed to
<code><a href='https://www.rdocumentation.org/packages/stats/topics/density'>stats::density()</a></code> to override default kernel density estimation
parameters. <code>n_dens</code> defaults to <code>1024</code>.</p></td>
    </tr>
    <tr>
      <th>compare</th>
      <td><p>For <code>ppc_loo_pit_qq()</code>, a string that can be either
<code>"uniform"</code> or <code>"normal"</code>. If <code>"uniform"</code> (the default) the Q-Q plot
compares computed PIT values to the standard uniform distribution. If
<code>compare="normal"</code>, the Q-Q plot compares standardized PIT values to the
standard normal distribution.</p></td>
    </tr>
    <tr>
      <th>psis_object</th>
      <td><p>If using <strong>loo</strong> version <code>2.0.0</code> or greater, an
object returned by the <code>psis()</code> function (or by the <code>loo()</code> function
with argument <code>save_psis</code> set to <code>TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>For <code>ppc_loo_intervals()</code> and <code>ppc_loo_ribbon()</code>, an optional
integer vector indicating which observations in <code>y</code> (and <code>yrep</code>) to
include. Dropping observations from <code>y</code> and <code>yrep</code> manually before passing
them to the plotting function will not work because the dimensions will not
match up with the dimensions of <code>psis_object</code>, but if all of <code>y</code> and <code>yrep</code>
are passed along with <code>subset</code> then <strong>bayesplot</strong> can do the subsetting
internally for <code>y</code>, <code>yrep</code> <em>and</em> <code>psis_object</code>. See the <strong>Examples</strong>
section for a demonstration.</p></td>
    </tr>
    <tr>
      <th>intervals</th>
      <td><p>For <code>ppc_loo_intervals()</code> and <code>ppc_loo_ribbon()</code>,
optionally a matrix of precomputed LOO predictive intervals
that can be specified instead of <code>yrep</code> and <code>lw</code> (these are both
ignored if <code>intervals</code> is specified). If not specified the intervals
are computed internally before plotting. If specified, <code>intervals</code>
must be a matrix with number of rows equal to the number of data points and
five columns in the following order: lower outer interval, lower inner
interval, median (50%), upper inner interval and upper outer interval
(column names are ignored).</p></td>
    </tr>
    <tr>
      <th>prob, prob_outer</th>
      <td><p>Values between 0 and 1 indicating the desired
probability mass to include in the inner and outer intervals. The defaults
are <code>prob=0.5</code> and <code>prob_outer=0.9</code>.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>For <code>ppc_loo_intervals()</code>, a string indicating how to arrange
the plotted intervals. The default (<code>"index"</code>) is to plot them in the
order of the observations. The alternative (<code>"median"</code>) arranges them
by median value from smallest (left) to largest (right).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A ggplot object that can be further customized using the <strong>ggplot2</strong> package.</p>
    
    <h2 class="hasAnchor" id="plot-descriptions"><a class="anchor" href="#plot-descriptions"></a>Plot Descriptions</h2>

    
    <dl class='dl-horizontal'>
<dt><code>ppc_loo_pit_overlay()</code>, <code>ppc_loo_pit_qq()</code></dt><dd><p>The calibration of marginal predictions can be assessed using probability
integral transformation (PIT) checks. LOO improves the check by avoiding the
double use of data. See the section on marginal predictive checks in Gelman
et al. (2013, p. 152--153) and section 5 of Gabry et al. (2019) for an
example of using <strong>bayesplot</strong> for these checks.
    The LOO PIT values are asymptotically uniform (for continuous data) if the
model is calibrated. The <code>ppc_loo_pit_overlay()</code> function creates a plot
comparing the density of the LOO PITs (thick line) to the density estimates
of many simulated data sets from the standard uniform distribution (thin
lines). See Gabry et al. (2019) for an example of interpreting the shape of
the miscalibration that can be observed in these plots.
    The <code>ppc_loo_pit_qq()</code> function provides an alternative visualization of
the miscalibration with a quantile-quantile (Q-Q) plot comparing the LOO
PITs to the standard uniform distribution. Comparing to the uniform is not
good for extreme probabilities close to 0 and 1, so it can sometimes be
useful to set the <code>compare</code> argument to <code>"normal"</code>, which will
produce a Q-Q plot comparing standardized PIT values to the standard normal
distribution that can help see the (mis)calibration better for the extreme
values. However, in most cases we have found that the overlaid density plot
(<code>ppc_loo_pit_overlay()</code>) function will provided a clearer picture of
calibration problems that the Q-Q plot.</p></dd>
<dt><code>ppc_loo_intervals()</code>, <code>ppc_loo_ribbon()</code></dt><dd><p>Similar to <code><a href='PPC-intervals.html'>ppc_intervals()</a></code> and <code><a href='PPC-intervals.html'>ppc_ribbon()</a></code> but the intervals are for
the LOO predictive distribution.</p></dd>
</dl>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari,
A., and Rubin, D. B. (2013). <em>Bayesian Data Analysis.</em> Chapman &amp; Hall/CRC
Press, London, third edition. (p. 152--153)</p>
<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and
Gelman, A. (2019), Visualization in Bayesian workflow.
<em>J. R. Stat. Soc. A</em>, 182: 389-402. doi:10.1111/rssa.12378.
(<a href='https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssa.12378'>journal version</a>,
<a href='https://arxiv.org/abs/1709.01449'>arXiv preprint</a>,
<a href='https://github.com/jgabry/bayes-vis-paper'>code on GitHub</a>)</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical
Bayesian model evaluation using leave-one-out cross-validation and WAIC.
<em>Statistics and Computing</em>. 27(5), 1413--1432.
doi:10.1007/s11222-016-9696-4. arXiv preprint:
<a href='https://arxiv.org/abs/1507.04544/'>https://arxiv.org/abs/1507.04544/</a></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other PPCs: <code><a href='PPC-discrete.html'>PPC-discrete</a></code>,
  <code><a href='PPC-distributions.html'>PPC-distributions</a></code>,
  <code><a href='PPC-errors.html'>PPC-errors</a></code>, <code><a href='PPC-intervals.html'>PPC-intervals</a></code>,
  <code><a href='PPC-overview.html'>PPC-overview</a></code>,
  <code><a href='PPC-scatterplots.html'>PPC-scatterplots</a></code>,
  <code><a href='PPC-test-statistics.html'>PPC-test-statistics</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>rstanarm</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>loo</span>)</div><div class='output co'>#&gt; <span class='message'>This is loo version 2.1.0.9000.</span>
#&gt; <span class='message'>**NOTE: As of version 2.0.0 loo defaults to 1 core but we recommend using as many as possible. Use the 'cores' argument or set options(mc.cores = NUM_CORES) for an entire session. Visit mc-stan.org/loo/news for details on other changes.</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘loo’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:rstan’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    loo</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:testthat’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    compare</span></div><div class='input'>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='no'>radon</span>)</div><div class='output co'>#&gt;   floor county  log_radon log_uranium
#&gt; 1     1 AITKIN 0.83290912  -0.6890476
#&gt; 2     0 AITKIN 0.83290912  -0.6890476
#&gt; 3     0 AITKIN 1.09861229  -0.6890476
#&gt; 4     0 AITKIN 0.09531018  -0.6890476
#&gt; 5     0  ANOKA 1.16315081  -0.8473129
#&gt; 6     0  ANOKA 0.95551145  -0.8473129</div><div class='input'><span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/rstanarm/topics/stan_glmer'>stan_lmer</a></span>(
  <span class='no'>log_radon</span> ~ <span class='no'>floor</span> + <span class='no'>log_uranium</span> + <span class='no'>floor</span>:<span class='no'>log_uranium</span>
               + (<span class='fl'>1</span> + <span class='no'>floor</span> <span class='kw'>|</span> <span class='no'>county</span>),
  <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>radon</span>,
  <span class='kw'>iter</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>chains</span> <span class='kw'>=</span> <span class='fl'>2</span>  <span class='co'># ,cores = 2</span>
 )</div><div class='output co'>#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 1).
#&gt; Chain 1: 
#&gt; Chain 1: Gradient evaluation took 0.000502 seconds
#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 5.02 seconds.
#&gt; Chain 1: Adjust your expectations accordingly!
#&gt; Chain 1: 
#&gt; Chain 1: 
#&gt; Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Chain 1: Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Chain 1: Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Chain 1: Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Chain 1: Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt; Chain 1: 
#&gt; Chain 1:  Elapsed Time: 13.7475 seconds (Warm-up)
#&gt; Chain 1:                3.248 seconds (Sampling)
#&gt; Chain 1:                16.9955 seconds (Total)
#&gt; Chain 1: 
#&gt; 
#&gt; SAMPLING FOR MODEL 'continuous' NOW (CHAIN 2).
#&gt; Chain 2: 
#&gt; Chain 2: Gradient evaluation took 0.0002 seconds
#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 2 seconds.
#&gt; Chain 2: Adjust your expectations accordingly!
#&gt; Chain 2: 
#&gt; Chain 2: 
#&gt; Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)
#&gt; Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)
#&gt; Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)
#&gt; Chain 2: Iteration: 300 / 1000 [ 30%]  (Warmup)
#&gt; Chain 2: Iteration: 400 / 1000 [ 40%]  (Warmup)
#&gt; Chain 2: Iteration: 500 / 1000 [ 50%]  (Warmup)
#&gt; Chain 2: Iteration: 501 / 1000 [ 50%]  (Sampling)
#&gt; Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)
#&gt; Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)
#&gt; Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)
#&gt; Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)
#&gt; Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)
#&gt; Chain 2: 
#&gt; Chain 2:  Elapsed Time: 14.2266 seconds (Warm-up)
#&gt; Chain 2:                3.13112 seconds (Sampling)
#&gt; Chain 2:                17.3577 seconds (Total)
#&gt; Chain 2: </div><div class='input'><span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>radon</span>$<span class='no'>log_radon</span>
<span class='no'>yrep</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/rstanarm/topics/posterior_predict.stanreg'>posterior_predict</a></span>(<span class='no'>fit</span>)

<span class='no'>loo1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/rstanarm/topics/loo.stanreg'>loo</a></span>(<span class='no'>fit</span>, <span class='kw'>save_psis</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>cores</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Found 2 observation(s) with a pareto_k &gt; 0.7. We recommend calling 'loo' again with argument 'k_threshold = 0.7' in order to calculate the ELPD without the assumption that these observations are negligible. This will refit the model 2 times to compute the ELPDs for the problematic observations directly.</span></div><div class='input'><span class='no'>psis1</span> <span class='kw'>&lt;-</span> <span class='no'>loo1</span>$<span class='no'>psis_object</span>
<span class='no'>lw</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/weights'>weights</a></span>(<span class='no'>psis1</span>)

<span class='co'># marginal predictive check using LOO probability integral transform</span>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span>(<span class='st'>"orange"</span>)
<span class='fu'>ppc_loo_pit_overlay</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>lw</span> <span class='kw'>=</span> <span class='no'>lw</span>)</div><div class='img'><img src='PPC-loo-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'>ppc_loo_pit_qq</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>lw</span> <span class='kw'>=</span> <span class='no'>lw</span>)</div><div class='img'><img src='PPC-loo-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>ppc_loo_pit_qq</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>lw</span> <span class='kw'>=</span> <span class='no'>lw</span>, <span class='kw'>compare</span> <span class='kw'>=</span> <span class='st'>"normal"</span>)</div><div class='img'><img src='PPC-loo-3.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'># loo predictive intervals vs observations</span>
<span class='no'>keep_obs</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>:<span class='fl'>50</span>
<span class='fu'>ppc_loo_intervals</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>psis_object</span> <span class='kw'>=</span> <span class='no'>psis1</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='no'>keep_obs</span>)</div><div class='img'><img src='PPC-loo-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'><a href='bayesplot-colors.html'>color_scheme_set</a></span>(<span class='st'>"gray"</span>)
<span class='fu'>ppc_loo_intervals</span>(<span class='no'>y</span>, <span class='no'>yrep</span>, <span class='kw'>psis_object</span> <span class='kw'>=</span> <span class='no'>psis1</span>, <span class='kw'>subset</span> <span class='kw'>=</span> <span class='no'>keep_obs</span>,
                  <span class='kw'>order</span> <span class='kw'>=</span> <span class='st'>"median"</span>)</div><div class='img'><img src='PPC-loo-5.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#plot-descriptions">Plot Descriptions</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonah Gabry, Tristan Mahr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

